#N canvas 570 107 442 182 10;
#X declare -path . -path rendering_algorithm/vbap -path ../externals
;
#N canvas 541 437 550 434 command_interpretation 0;
#X obj 26 16 inlet;
#N canvas 324 117 272 250 PropertiesOfAudioFile 0;
#X obj 29 39 inlet;
#X obj 61 181 readsf~;
#X obj 61 134 list prepend open;
#X obj 61 157 list trim;
#X obj 29 73 t b a;
#X msg 28 112 print;
#X obj 180 133 openpanel;
#X obj 180 104 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X msg 180 164 open \$1;
#X connect 0 0 4 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X connect 4 0 5 0;
#X connect 4 1 2 0;
#X connect 5 0 1 0;
#X connect 6 0 8 0;
#X connect 7 0 6 0;
#X connect 8 0 1 0;
#X restore 26 172 pd PropertiesOfAudioFile;
#N canvas 469 273 681 649 Transport 0;
#X obj 85 4 inlet;
#X obj 29 186 bang~;
#X obj 55 232 f;
#X obj 55 269 + 64;
#X obj 56 327 / 44100;
#X text 10 360 elapsed time;
#X obj 178 415 +;
#X obj 163 586 s toZTE;
#X text 219 385 offset Time;
#X obj 353 61 print Transport_unknown_message;
#X obj 95 299 r SampleRate;
#X obj 163 490 f;
#X obj 56 391 t b f;
#X obj 94 422 + 1;
#X obj 56 423 f;
#X msg 8 442 0, f 4;
#X obj 56 473 sel 25;
#X obj 253 69 r SampleRate;
#X text 296 108 fps;
#X floatatom 253 145 5 0 0 0 - - -;
#X text 301 140 samples per frame;
#X obj 253 180 / 64;
#X floatatom 253 218 5 0 0 0 - - -;
#X obj 253 241 i;
#X obj 253 269 print update_skip;
#X obj 253 107 / 30;
#X msg 92 175 64;
#X msg 150 174 0;
#X text 299 215 number of blocks per refresh;
#X obj 86 32 route play poll setCurrentTime refreshRate;
#X obj 131 223 t b f;
#X msg 87 229 0;
#X msg 435 513 set poll;
#X obj 141 104 t b b;
#X obj 88 108 t b b;
#X msg 247 513 set currentTime \, adddollar 1;
#X msg 163 559 poll;
#X obj 84 564 send poll;
#X obj 58 537 t b b;
#X text 12 155 master clock;
#X connect 0 0 29 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 2 1;
#X connect 3 0 4 0;
#X connect 4 0 12 0;
#X connect 6 0 11 1;
#X connect 10 0 4 1;
#X connect 11 0 36 0;
#X connect 12 0 14 0;
#X connect 12 1 6 0;
#X connect 13 0 14 1;
#X connect 14 0 13 0;
#X connect 14 0 16 0;
#X connect 15 0 14 1;
#X connect 16 0 15 0;
#X connect 16 0 38 0;
#X connect 17 0 25 0;
#X connect 19 0 21 0;
#X connect 21 0 22 0;
#X connect 22 0 23 0;
#X connect 23 0 24 0;
#X connect 23 0 16 1;
#X connect 25 0 19 0;
#X connect 26 0 30 0;
#X connect 27 0 30 0;
#X connect 29 0 34 0;
#X connect 29 1 33 0;
#X connect 29 2 6 1;
#X connect 29 3 25 1;
#X connect 29 4 9 0;
#X connect 30 0 31 0;
#X connect 30 1 3 1;
#X connect 31 0 2 1;
#X connect 32 0 36 0;
#X connect 33 0 27 0;
#X connect 33 1 32 0;
#X connect 34 0 26 0;
#X connect 34 1 35 0;
#X connect 35 0 36 0;
#X connect 36 0 7 0;
#X connect 38 0 11 0;
#X connect 38 1 37 0;
#X restore 48 191 pd Transport;
#N canvas 98 41 748 532 AudioFileInspection 0;
#X obj 102 16 inlet;
#X obj 119 244 soundfiler;
#X obj 101 64 route loadToBuffer freeBuffer;
#X msg 186 311 buffer freed;
#X msg 5 223 buffer loaded;
#X obj 119 272 list prepend number of samples;
#X obj 6 122 t b a;
#X obj 119 308 list trim;
#X obj 119 402 print PDmemory;
#X obj 119 371 spigot;
#X obj 193 346 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 440 261 table fileInspectionBuffer1;
#X obj 440 280 table fileInspectionBuffer2;
#X msg 119 166 read -maxsize \$1 -skip \$2 -resize \$3 fileInspectionBuffer1
fileInspectionBuffer2 fileInspectionBuffer3 fileInspectionBuffer4 fileInspectionBuffer5
fileInspectionBuffer6 fileInspectionBuffer7 fileInspectionBuffer8;
#X obj 440 299 table fileInspectionBuffer3;
#X obj 440 318 table fileInspectionBuffer4;
#X obj 440 337 table fileInspectionBuffer5;
#X obj 440 356 table fileInspectionBuffer6;
#X obj 440 375 table fileInspectionBuffer7;
#X obj 440 394 table fileInspectionBuffer8;
#X msg 500 81 \; fileInspectionBuffer1 resize 0 \; fileInspectionBuffer2
resize 0 \; fileInspectionBuffer3 resize 0 \; fileInspectionBuffer4
resize 0 \; fileInspectionBuffer5 resize 0 \; fileInspectionBuffer6
resize 0 \; fileInspectionBuffer7 resize 0 \; fileInspectionBuffer8
resize 0 \;;
#X text 165 16 This functionality is exclusively used for creating
waveform representation in ZTE;
#X connect 0 0 2 0;
#X connect 1 0 5 0;
#X connect 2 0 6 0;
#X connect 2 1 20 0;
#X connect 2 1 3 0;
#X connect 3 0 9 0;
#X connect 4 0 9 0;
#X connect 5 0 7 0;
#X connect 6 0 4 0;
#X connect 6 1 13 0;
#X connect 7 0 9 0;
#X connect 9 0 8 0;
#X connect 10 0 9 1;
#X connect 13 0 1 0;
#X restore 71 212 pd AudioFileInspection;
#X obj 93 232 s SampleRate;
#X obj 116 252 s ID;
#X obj 139 272 s Speaker;
#X obj 184 315 s vbapMapping;
#X obj 161 294 s SpeakerDef;
#N canvas 580 415 649 501 vbap 0;
#X obj 129 259 s vbapDef;
#X obj 131 204 define_loudspeakers 2 0 45 90 135;
#X obj 133 152 list prepend ls-directions;
#X text 342 193 <- dummy;
#X obj 81 73 t b a;
#X obj 132 177 list trim;
#N canvas 393 359 476 606 convert 0;
#X obj 112 14 inlet;
#X obj 149 562 outlet;
#X obj 221 195 until;
#X obj 221 233 list append;
#X obj 313 238 bang;
#X obj 221 263 list split 2;
#X obj 220 287 unpack 0 0;
#X obj 217 357 circlewrap;
#X obj 222 380 pack 0 0;
#X obj 203 440 list append;
#X obj 323 415 t l;
#X obj 221 406 list prepend;
#X obj 202 167 t b b l b;
#X obj 143 525 list prepend;
#X obj 74 200 until;
#X obj 74 238 list append;
#X obj 166 243 bang;
#X obj 70 362 circlewrap;
#X obj 56 445 list append;
#X obj 176 420 t l;
#X obj 74 411 list prepend;
#X obj 55 172 t b b l b;
#X obj 74 268 list split 1;
#X obj 222 309 * -1;
#X obj 222 330 + 90;
#X obj 75 314 * -1;
#X obj 75 335 + 90;
#X obj 107 98 route 2 3;
#X obj 232 488 list prepend 3;
#X obj 72 484 list prepend 2;
#X connect 0 0 27 0;
#X connect 2 0 3 0;
#X connect 3 0 5 0;
#X connect 4 0 2 1;
#X connect 5 0 6 0;
#X connect 5 1 3 1;
#X connect 5 2 4 0;
#X connect 6 0 23 0;
#X connect 6 1 8 1;
#X connect 7 0 8 0;
#X connect 8 0 11 0;
#X connect 9 0 28 0;
#X connect 10 0 11 1;
#X connect 11 0 10 0;
#X connect 11 0 9 1;
#X connect 12 0 9 0;
#X connect 12 1 2 0;
#X connect 12 2 3 1;
#X connect 12 3 11 1;
#X connect 13 0 1 0;
#X connect 14 0 15 0;
#X connect 15 0 22 0;
#X connect 16 0 14 1;
#X connect 17 0 20 0;
#X connect 18 0 29 0;
#X connect 19 0 20 1;
#X connect 20 0 19 0;
#X connect 20 0 18 1;
#X connect 21 0 18 0;
#X connect 21 1 14 0;
#X connect 21 2 15 1;
#X connect 21 3 20 1;
#X connect 22 0 25 0;
#X connect 22 1 15 1;
#X connect 22 2 16 0;
#X connect 23 0 24 0;
#X connect 24 0 7 0;
#X connect 25 0 26 0;
#X connect 26 0 17 0;
#X connect 27 0 21 0;
#X connect 27 1 12 0;
#X connect 28 0 13 0;
#X connect 29 0 13 0;
#X restore 133 118 pd convert;
#X obj 369 410 s toZTE;
#X obj 244 301 route selectedTriplet;
#X obj 368 361 list prepend triplet;
#X obj 368 386 list trim;
#X obj 367 337 list prepend -1;
#X obj 81 42 r SpeakerDef;
#X obj 222 255 zirkvbap;
#X connect 1 0 0 0;
#X connect 1 0 13 0;
#X connect 2 0 5 0;
#X connect 4 0 1 0;
#X connect 4 1 6 0;
#X connect 5 0 1 0;
#X connect 6 0 2 0;
#X connect 8 1 11 0;
#X connect 9 0 10 0;
#X connect 10 0 7 0;
#X connect 11 0 9 0;
#X connect 12 0 4 0;
#X connect 13 4 8 0;
#X restore 31 334 pd vbap;
#N canvas 0 23 459 366 speakerNum 0;
#X obj 250 42 r SpeakerDef;
#X obj 212 127 list length;
#X floatatom 214 172 5 0 0 0 - - -;
#X obj 214 201 - 1;
#X text 20 193 because first one is dimension;
#X obj 246 67 t l l;
#X msg 304 128 \$1;
#X obj 309 166 sel 2 3;
#X msg 310 228 1;
#X msg 345 228 2;
#X obj 218 247 / 1;
#X floatatom 216 273 5 0 0 0 - - -;
#X obj 217 296 s NumSpeakers;
#X connect 0 0 5 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 10 0;
#X connect 5 0 1 0;
#X connect 5 1 6 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 7 1 9 0;
#X connect 8 0 10 1;
#X connect 9 0 10 1;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X restore 31 357 pd speakerNum;
#X obj 206 337 s HRTF;
#N canvas 0 23 450 300 Report 0;
#X obj 79 75 inlet;
#X obj 79 122 route enableIDLevelReport enableSpeakerLevelReport;
#X obj 76 161 s IDLevelReport;
#X obj 219 161 s SpeakerLevelReport;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 1 3 0;
#X restore 229 359 pd Report;
#X obj 252 382 s SoundFile;
#X obj 365 168 print error-invalidCommand;
#X text 35 402 distributes commands from the Trajectory Editor;
#X obj 82 28 inlet;
#X obj 49 52 spigot;
#X obj 399 113 t f;
#X obj 49 79 print verbose;
#N canvas 0 23 229 205 vbap 0;
#X obj 51 34 inlet;
#X obj 51 95 moses 0;
#X obj 51 64 route speed;
#X obj 90 119 s #vbap;
#X connect 0 0 2 0;
#X connect 1 1 3 0;
#X connect 2 0 1 0;
#X restore 319 201 pd vbap;
#X obj 26 114 route PropertiesOfAudioFile Transport AudioFileInspection
SampleRate ID Speaker SpeakerDef vbapMapping hrtf Report SoundFile
input output vbap Verbose;
#N canvas 0 23 207 237 output 0;
#X obj 42 128 dbtorms;
#X obj 42 19 inlet;
#X obj 42 182 s #zirk_output;
#X msg 42 154 gain \$1;
#X obj 42 45 route gain;
#X obj 42 70 clip -100 12;
#X obj 42 98 + 100;
#X connect 0 0 3 0;
#X connect 1 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 0 0;
#X restore 297 232 pd output;
#N canvas 0 23 165 231 input 0;
#X obj 42 128 dbtorms;
#X obj 42 19 inlet;
#X msg 42 159 gain \$1;
#X obj 42 45 route gain;
#X obj 42 70 clip -100 12;
#X obj 42 98 + 100;
#X obj 42 187 s #zirk_input;
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 6 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 0 0;
#X restore 274 260 pd input;
#X connect 0 0 17 0;
#X connect 0 0 21 0;
#X connect 16 0 17 1;
#X connect 17 0 19 0;
#X connect 18 0 17 1;
#X connect 21 0 1 0;
#X connect 21 1 2 0;
#X connect 21 2 3 0;
#X connect 21 3 4 0;
#X connect 21 4 5 0;
#X connect 21 5 6 0;
#X connect 21 6 8 0;
#X connect 21 7 7 0;
#X connect 21 8 11 0;
#X connect 21 9 12 0;
#X connect 21 10 13 0;
#X connect 21 11 23 0;
#X connect 21 12 22 0;
#X connect 21 13 20 0;
#X connect 21 14 18 0;
#X connect 21 15 14 0;
#X restore 29 37 pd command_interpretation;
#N canvas 0 23 334 232 report 0;
#X obj 40 20 loadbang;
#X obj 40 96 print;
#X obj 40 130 loadbang;
#X msg 40 159 \; pd dsp 1;
#X obj 59 71 r pd;
#X msg 40 46 Zirkonium Spatialization Server 3.4;
#X connect 0 0 5 0;
#X connect 2 0 3 0;
#X connect 4 0 1 0;
#X connect 5 0 1 0;
#X restore 354 71 pd report;
#X obj 29 12 r fromZTE;
#X text 191 95 ID (sound object) layer;
#N canvas 781 75 456 141 inputs 0;
#X obj 66 26 send~ noinput;
#X text 62 85 input from the hardware. Max 64 channels. You can find
receive~ in ID;
#X obj 66 56 clone -s 1 64 zirk_input;
#X restore 28 70 pd inputs;
#X obj 176 13 tgl 15 0 empty empty verbose 17 7 0 10 -262144 -1 -1
0 1;
#N canvas 0 23 382 196 declare 0;
#X obj 30 49 declare -path . -path rendering_algorithm/vbap -path ../externals
;
#X text 23 15 add local paths so includd externals will load;
#X restore 354 102 pd declare;
#N canvas 0 23 292 226 HRTF 0;
#X obj 65 33 catch~ hrtfL;
#X obj 155 33 catch~ hrtfR;
#X obj 104 170 dac~;
#X obj 65 114 *~ 0;
#X obj 155 118 *~ 0;
#X obj 176 77 r MasterGain;
#X connect 0 0 3 0;
#X connect 1 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 2 1;
#X connect 5 0 3 1;
#X connect 5 0 4 1;
#X restore 354 133 pd HRTF;
#N canvas 155 313 583 134 sourcefiles 0;
#X text 206 47 you can play upto 64 files at the same time. Audio signal
from the sound file will be sent to "receive~ playerID channelID".
Note \, channel ID starts from 1 playerID starts from 0;
#X text 206 26 source file players;
#X obj 32 27 clone zirk_sourcefile 64;
#X restore 93 70 pd sourcefiles;
#X text 191 73 source layer;
#X text 192 119 virtual speaker layer;
#X text 191 144 hardware output layer;
#N canvas 1034 483 320 114 ids 0;
#N canvas 288 241 727 458 testID 0;
#X obj 478 163 switch~;
#X obj 478 118 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 477 51 loadbang;
#X msg 478 87 0;
#X obj 231 70 noise~;
#X text 274 95 - 6dB;
#X obj 315 51 r ID;
#X obj 315 96 route 0;
#X obj 311 141 route position activate;
#X obj 433 244 print IDActivation;
#X obj 408 276 print IDDeactivation;
#X obj 408 209 route 0 1;
#X obj 408 179 pack 0 \$1;
#X obj 348 181 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 231 97 *~ 0.1;
#X obj 293 208 sel 1;
#X obj 333 212 t f f;
#X msg 286 236 0;
#X obj 229 263 VBAPModule 0;
#X obj 41 158 == 1;
#X obj 126 157 == 0;
#X obj 137 105 loadbang;
#X msg 137 130 0;
#X obj 212 213 *~;
#X obj 71 96 r HRTF;
#X obj 42 312 *~;
#X obj 43 372 throw~ hrtfL;
#X obj 130 372 throw~ hrtfR;
#N canvas 0 23 450 300 HRTF 0;
#X obj 133 105 unpack 0 0;
#X obj 133 164 pack 0 25;
#X obj 197 167 pack 0 25;
#X obj 195 189 line 0 5;
#X obj 130 186 line 0 5;
#N canvas 0 23 450 300 hrtf_convert 0;
#X obj 133 119 * -1;
#X obj 131 166 + 360;
#X obj 131 141 moses 0;
#X obj 136 71 inlet;
#X obj 136 205 outlet;
#X connect 0 0 2 0;
#X connect 1 0 4 0;
#X connect 2 0 1 0;
#X connect 2 1 4 0;
#X connect 3 0 0 0;
#X restore 132 138 pd hrtf_convert;
#X obj 40 112 inlet~;
#X obj 88 250 outlet~;
#X obj 146 247 outlet~;
#X obj 282 147 switch~;
#X obj 281 122 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X msg 307 105 0;
#X obj 346 73 loadbang;
#X obj 278 70 r HRTF;
#X obj 135 65 inlet;
#X text 103 215 hrtf;
#X connect 0 0 5 0;
#X connect 0 1 2 0;
#X connect 1 0 4 0;
#X connect 2 0 3 0;
#X connect 5 0 1 0;
#X connect 10 0 9 0;
#X connect 11 0 10 0;
#X connect 12 0 11 0;
#X connect 13 0 10 0;
#X connect 14 0 0 0;
#X restore 43 341 pd HRTF;
#X connect 1 0 0 0;
#X connect 1 0 12 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X connect 4 0 14 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 8 0 28 1;
#X connect 8 0 18 1;
#X connect 8 1 1 0;
#X connect 8 1 13 0;
#X connect 11 0 10 0;
#X connect 11 1 9 0;
#X connect 12 0 11 0;
#X connect 13 0 16 0;
#X connect 14 0 23 1;
#X connect 14 0 25 1;
#X connect 15 0 17 0;
#X connect 16 0 15 0;
#X connect 16 1 18 3;
#X connect 17 0 18 2;
#X connect 19 0 25 0;
#X connect 20 0 23 0;
#X connect 21 0 22 0;
#X connect 22 0 20 0;
#X connect 23 0 18 0;
#X connect 24 0 19 0;
#X connect 24 0 20 0;
#X connect 25 0 28 0;
#X connect 28 0 26 0;
#X connect 28 1 27 0;
#X restore 239 52 pd testID;
#X text 23 57 represents each ID (sound object);
#X obj 27 22 clone -s 1 64 zirk_id;
#X restore 28 93 pd ids;
#N canvas 424 327 392 116 speakers 0;
#X obj 201 26 catch~ out0;
#X text 14 53 represent speaker. The connection of speaker and hardware
out can be configurable. Thus the numbers above are NOT hardware out
channels.;
#X obj 17 25 clone -s 1 64 zirk_speaker;
#X restore 28 116 pd speakers;
#N canvas 159 321 263 80 outputs 0;
#X text 40 16 hardware out | max 64 channels;
#X obj 43 40 clone -s 1 64 zirk_output;
#X restore 28 139 pd outputs;
#X connect 2 0 0 0;
#X connect 5 0 0 1;
