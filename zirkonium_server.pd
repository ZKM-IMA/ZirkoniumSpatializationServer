#N canvas 570 107 442 182 10;
#X declare -path . -path rendering_algorithm/vbap -path ../externals
;
#N canvas 541 437 550 434 command_interpretation 0;
#X obj 26 16 inlet;
#N canvas 324 117 272 250 PropertiesOfAudioFile 0;
#X obj 29 39 inlet;
#X obj 61 181 readsf~;
#X obj 61 134 list prepend open;
#X obj 61 157 list trim;
#X obj 29 73 t b a;
#X msg 29 106 print;
#X obj 180 133 openpanel;
#X obj 180 104 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X msg 180 164 open \$1;
#X connect 0 0 4 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X connect 4 0 5 0;
#X connect 4 1 2 0;
#X connect 5 0 1 0;
#X connect 6 0 8 0;
#X connect 7 0 6 0;
#X connect 8 0 1 0;
#X restore 26 172 pd PropertiesOfAudioFile;
#N canvas 469 273 550 615 Transport 0;
#X obj 71 8 inlet;
#X obj 56 262 f;
#X obj 56 299 + 64;
#X obj 56 327 / 44100;
#X text 10 360 elapsed time;
#X obj 178 415 +;
#X text 219 385 offset Time;
#X obj 320 78 print Transport_unknown_message;
#X obj 95 299 r SampleRate;
#X obj 163 490 f;
#X obj 56 391 t b f;
#X obj 89 424 + 1;
#X obj 56 423 f;
#X msg 14 423 0, f 4;
#X obj 56 473 sel 25;
#X obj 236 78 r SampleRate;
#X text 279 110 fps;
#X text 281 184 samples per frame;
#X obj 236 182 / 64;
#X obj 236 243 i;
#X obj 236 271 print update_skip;
#X obj 236 109 / 30;
#X msg 71 177 64;
#X msg 133 177 0;
#X text 268 242 number of blocks per refresh;
#X obj 71 35 route play poll setCurrentTime refreshRate;
#X obj 71 212 t b f;
#X msg 71 237 0;
#X msg 393 491 set poll;
#X obj 133 110 t b b;
#X obj 71 110 t b b;
#X msg 204 490 set currentTime \, adddollar 1;
#X msg 163 552 poll;
#X obj 83 549 send poll;
#X obj 56 522 t b b;
#X text 33 154 master clock;
#X obj 163 579 s #zirk-out;
#X obj 27 176 bang~;
#X connect 0 0 25 0;
#X connect 1 0 2 0;
#X connect 2 0 1 1;
#X connect 2 0 3 0;
#X connect 3 0 10 0;
#X connect 5 0 9 1;
#X connect 8 0 3 1;
#X connect 9 0 32 0;
#X connect 10 0 12 0;
#X connect 10 1 5 0;
#X connect 11 0 12 1;
#X connect 12 0 11 0;
#X connect 12 0 14 0;
#X connect 13 0 12 1;
#X connect 14 0 13 0;
#X connect 14 0 34 0;
#X connect 15 0 21 0;
#X connect 18 0 19 0;
#X connect 19 0 20 0;
#X connect 19 0 14 1;
#X connect 21 0 18 0;
#X connect 22 0 26 0;
#X connect 23 0 26 0;
#X connect 25 0 30 0;
#X connect 25 1 29 0;
#X connect 25 2 5 1;
#X connect 25 3 21 1;
#X connect 25 4 7 0;
#X connect 26 0 27 0;
#X connect 26 1 2 1;
#X connect 27 0 1 1;
#X connect 28 0 32 0;
#X connect 29 0 23 0;
#X connect 29 1 28 0;
#X connect 30 0 22 0;
#X connect 30 1 31 0;
#X connect 31 0 32 0;
#X connect 32 0 36 0;
#X connect 34 0 9 0;
#X connect 34 1 33 0;
#X connect 37 0 1 0;
#X restore 48 191 pd Transport;
#N canvas 98 41 715 448 AudioFileInspection 0;
#X obj 118 19 inlet;
#X obj 136 247 soundfiler;
#X obj 118 67 route loadToBuffer freeBuffer;
#X msg 203 312 buffer freed;
#X msg 23 211 buffer loaded;
#X obj 136 275 list prepend number of samples;
#X obj 23 125 t b a;
#X obj 136 311 list trim;
#X obj 136 374 spigot;
#X obj 169 355 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X text 182 19 This functionality is exclusively used for creating
waveform representation in ZTE;
#X msg 518 126 \; zirk_filebuffer1 resize 0 \; zirk_filebuffer2 resize
0 \; zirk_filebuffer3 resize 0 \; zirk_filebuffer4 resize 0 \; zirk_filebuffer5
resize 0 \; zirk_filebuffer6 resize 0 \; zirk_filebuffer7 resize 0
\; zirk_filebuffer8 resize 0 \;;
#X msg 136 169 read -maxsize \$1 -skip \$2 -resize \$3 zirk_filebuffer1
zirk_filebuffer2 zirk_filebuffer3 zirk_filebuffer4 zirk_filebuffer5
zirk_filebuffer6 zirk_filebuffer7 zirk_filebuffer8;
#X obj 136 405 print file buffer;
#X obj 457 264 table zirk_filebuffer1;
#X obj 457 283 table zirk_filebuffer2;
#X obj 457 302 table zirk_filebuffer3;
#X obj 457 321 table zirk_filebuffer4;
#X obj 457 340 table zirk_filebuffer5;
#X obj 457 359 table zirk_filebuffer6;
#X obj 457 377 table zirk_filebuffer7;
#X obj 457 397 table zirk_filebuffer8;
#X connect 0 0 2 0;
#X connect 1 0 5 0;
#X connect 2 0 6 0;
#X connect 2 1 11 0;
#X connect 2 1 3 0;
#X connect 3 0 8 0;
#X connect 4 0 8 0;
#X connect 5 0 7 0;
#X connect 6 0 4 0;
#X connect 6 1 12 0;
#X connect 7 0 8 0;
#X connect 8 0 13 0;
#X connect 9 0 8 1;
#X connect 12 0 1 0;
#X restore 71 212 pd AudioFileInspection;
#X obj 93 232 s SampleRate;
#X obj 116 252 s ID;
#X obj 139 272 s Speaker;
#X obj 184 315 s vbapMapping;
#X obj 161 294 s SpeakerDef;
#N canvas 580 415 496 409 vbap 0;
#X obj 82 226 s vbapDef;
#X obj 82 176 define_loudspeakers 2 0 45 90 135;
#X obj 82 124 list prepend ls-directions;
#X text 300 177 <- dummy;
#X obj 55 69 t b a;
#X obj 82 149 list trim;
#N canvas 989 322 359 536 convert 0;
#X obj 115 32 inlet;
#X obj 137 495 outlet;
#X obj 209 146 until;
#X obj 209 171 list append;
#X obj 301 163 bang;
#X obj 209 201 list split 2;
#X obj 209 225 unpack 0 0;
#X obj 209 295 circlewrap;
#X obj 209 318 pack 0 0;
#X obj 192 378 list append;
#X obj 304 359 t l;
#X obj 209 344 list prepend;
#X obj 192 105 t b b l b;
#X obj 62 145 until;
#X obj 62 179 list append;
#X obj 147 162 bang;
#X obj 62 299 circlewrap;
#X obj 45 383 list append;
#X obj 149 348 t l;
#X obj 62 325 list prepend;
#X obj 45 110 t b b l b;
#X obj 62 209 list split 1;
#X obj 209 249 * -1;
#X obj 209 270 + 90;
#X obj 62 252 * -1;
#X obj 62 273 + 90;
#X obj 115 64 route 2 3;
#X obj 192 416 list prepend 3;
#X obj 45 416 list prepend 2;
#X connect 0 0 26 0;
#X connect 2 0 3 0;
#X connect 3 0 5 0;
#X connect 4 0 2 1;
#X connect 5 0 6 0;
#X connect 5 1 3 1;
#X connect 5 2 4 0;
#X connect 6 0 22 0;
#X connect 6 1 8 1;
#X connect 7 0 8 0;
#X connect 8 0 11 0;
#X connect 9 0 27 0;
#X connect 10 0 11 1;
#X connect 11 0 10 0;
#X connect 11 0 9 1;
#X connect 12 0 9 0;
#X connect 12 1 2 0;
#X connect 12 2 3 1;
#X connect 12 3 11 1;
#X connect 13 0 14 0;
#X connect 14 0 21 0;
#X connect 15 0 13 1;
#X connect 16 0 19 0;
#X connect 17 0 28 0;
#X connect 18 0 19 1;
#X connect 19 0 18 0;
#X connect 19 0 17 1;
#X connect 20 0 17 0;
#X connect 20 1 13 0;
#X connect 20 2 14 1;
#X connect 20 3 19 1;
#X connect 21 0 24 0;
#X connect 21 1 14 1;
#X connect 21 2 15 0;
#X connect 22 0 23 0;
#X connect 23 0 7 0;
#X connect 24 0 25 0;
#X connect 25 0 16 0;
#X connect 26 0 20 0;
#X connect 26 1 12 0;
#X connect 27 0 1 0;
#X connect 28 0 1 0;
#X restore 82 98 pd convert;
#X obj 216 256 route selectedTriplet;
#X obj 339 316 list prepend triplet;
#X obj 339 341 list trim;
#X obj 339 292 list prepend -1;
#X obj 55 38 r SpeakerDef;
#X obj 171 227 zirkvbap;
#X obj 339 365 s #zirk-out;
#X connect 1 0 0 0;
#X connect 1 0 12 0;
#X connect 2 0 5 0;
#X connect 4 0 1 0;
#X connect 4 1 6 0;
#X connect 5 0 1 0;
#X connect 6 0 2 0;
#X connect 7 1 10 0;
#X connect 8 0 9 0;
#X connect 9 0 13 0;
#X connect 10 0 8 0;
#X connect 11 0 4 0;
#X connect 12 4 7 0;
#X restore 31 334 pd vbap;
#N canvas 0 23 459 366 speakerNum 0;
#X obj 202 58 r SpeakerDef;
#X obj 202 123 list length;
#X obj 202 164 - 1;
#X obj 202 88 t l l;
#X msg 299 124 \$1;
#X obj 299 164 sel 2 3;
#X msg 299 188 1;
#X msg 334 188 2;
#X obj 202 221 / 1;
#X obj 202 260 s NumSpeakers;
#X text 26 163 first element is dimension;
#X connect 0 0 3 0;
#X connect 1 0 2 0;
#X connect 2 0 8 0;
#X connect 3 0 1 0;
#X connect 3 1 4 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 5 1 7 0;
#X connect 6 0 8 1;
#X connect 7 0 8 1;
#X connect 8 0 9 0;
#X restore 31 357 pd speakerNum;
#X obj 206 337 s HRTF;
#N canvas 0 23 450 300 Report 0;
#X obj 79 75 inlet;
#X obj 79 122 route enableIDLevelReport enableSpeakerLevelReport;
#X obj 76 161 s IDLevelReport;
#X obj 219 161 s SpeakerLevelReport;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 1 3 0;
#X restore 229 359 pd Report;
#X obj 252 382 s SoundFile;
#X text 142 17 distributes commands from the Trajectory Editor;
#X obj 82 28 inlet;
#X obj 49 52 spigot;
#X obj 399 113 t f;
#N canvas 0 23 229 205 vbap 0;
#X obj 51 34 inlet;
#X obj 51 95 moses 0;
#X obj 51 64 route speed;
#X obj 90 119 s #zirk_vbap;
#X connect 0 0 2 0;
#X connect 1 1 3 0;
#X connect 2 0 1 0;
#X restore 319 201 pd vbap;
#X obj 26 114 route PropertiesOfAudioFile Transport AudioFileInspection
SampleRate ID Speaker SpeakerDef vbapMapping hrtf Report SoundFile
input output vbap Verbose;
#N canvas 0 23 207 237 output 0;
#X obj 42 128 dbtorms;
#X obj 42 19 inlet;
#X obj 42 182 s #zirk_output;
#X msg 42 154 gain \$1;
#X obj 42 45 route gain;
#X obj 42 70 clip -100 12;
#X obj 42 98 + 100;
#X connect 0 0 3 0;
#X connect 1 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 0 0;
#X restore 297 232 pd output;
#N canvas 0 23 165 231 input 0;
#X obj 42 128 dbtorms;
#X obj 42 19 inlet;
#X msg 42 159 gain \$1;
#X obj 42 45 route gain;
#X obj 42 70 clip -100 12;
#X obj 42 98 + 100;
#X obj 42 187 s #zirk_input;
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 6 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 0 0;
#X restore 274 260 pd input;
#X obj 365 168 print zirk unknown command;
#X obj 49 79 print verbose;
#X connect 0 0 16 0;
#X connect 0 0 19 0;
#X connect 15 0 16 1;
#X connect 16 0 23 0;
#X connect 17 0 16 1;
#X connect 19 0 1 0;
#X connect 19 1 2 0;
#X connect 19 2 3 0;
#X connect 19 3 4 0;
#X connect 19 4 5 0;
#X connect 19 5 6 0;
#X connect 19 6 8 0;
#X connect 19 7 7 0;
#X connect 19 8 11 0;
#X connect 19 9 12 0;
#X connect 19 10 13 0;
#X connect 19 11 21 0;
#X connect 19 12 20 0;
#X connect 19 13 18 0;
#X connect 19 14 17 0;
#X connect 19 15 22 0;
#X restore 29 37 pd command_interpretation;
#N canvas 0 23 334 232 report 0;
#X obj 40 20 loadbang;
#X obj 40 96 print;
#X obj 40 130 loadbang;
#X msg 40 159 \; pd dsp 1;
#X obj 59 71 r pd;
#X msg 40 46 Zirkonium Spatialization Server 2;
#X connect 0 0 5 0;
#X connect 2 0 3 0;
#X connect 4 0 1 0;
#X connect 5 0 1 0;
#X restore 354 71 pd report;
#X text 191 95 ID (sound object) layer;
#N canvas 781 75 456 141 inputs 0;
#X obj 66 26 send~ noinput;
#X text 62 85 input from the hardware. Max 64 channels. You can find
receive~ in ID;
#X obj 66 56 clone -s 1 64 zirk_input;
#X restore 28 70 pd inputs;
#X obj 176 12 tgl 15 0 empty empty verbose 17 7 0 10 -262144 -1 -1
0 1;
#N canvas 0 23 382 196 declare 0;
#X obj 30 49 declare -path . -path rendering_algorithm/vbap -path ../externals
;
#X text 23 15 add local paths so included externals will load;
#X restore 354 102 pd declare;
#N canvas 0 23 292 226 HRTF 0;
#X obj 65 33 catch~ hrtfL;
#X obj 155 33 catch~ hrtfR;
#X obj 65 169 dac~;
#X obj 65 124 *~ 0;
#X obj 155 124 *~ 0;
#X obj 176 62 r #zirk_output;
#X obj 176 87 route gain;
#X connect 0 0 3 0;
#X connect 1 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 2 1;
#X connect 5 0 6 0;
#X connect 6 0 3 1;
#X connect 6 0 4 1;
#X restore 354 133 pd HRTF;
#N canvas 155 313 583 134 sourcefiles 0;
#X text 206 47 you can play upto 64 files at the same time. Audio signal
from the sound file will be sent to "receive~ playerID channelID".
Note \, channel ID starts from 1 playerID starts from 0;
#X text 206 26 source file players;
#X obj 32 27 clone zirk_sourcefile 64;
#X restore 93 70 pd sourcefiles;
#X text 192 119 virtual speaker layer;
#X text 191 144 hardware output layer;
#N canvas 1034 483 274 100 ids 0;
#N canvas 288 241 641 365 testID 0;
#X obj 424 198 switch~;
#X obj 424 153 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 424 96 loadbang;
#X msg 424 122 0;
#X obj 57 135 noise~;
#X obj 266 40 r ID;
#X obj 266 69 route 0;
#X obj 266 96 route position activate;
#X obj 513 236 print IDActivation;
#X obj 488 268 print IDDeactivation;
#X obj 488 201 route 0 1;
#X obj 488 171 pack 0 \$1;
#X obj 333 153 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 333 211 sel 1;
#X obj 333 180 t f f;
#X msg 333 236 0;
#X obj 287 267 VBAPModule 0;
#X obj 42 105 == 1;
#X obj 145 105 == 0;
#X obj 145 40 loadbang;
#X msg 145 69 0;
#X obj 145 208 *~;
#X obj 42 40 r HRTF;
#X obj 42 259 *~;
#X obj 42 319 throw~ hrtfL;
#X obj 129 319 throw~ hrtfR;
#N canvas 0 23 450 300 HRTF 0;
#X obj 133 105 unpack 0 0;
#X obj 133 164 pack 0 25;
#X obj 197 167 pack 0 25;
#X obj 195 189 line 0 5;
#X obj 130 186 line 0 5;
#N canvas 0 23 450 300 hrtf_convert 0;
#X obj 133 119 * -1;
#X obj 131 166 + 360;
#X obj 131 141 moses 0;
#X obj 136 71 inlet;
#X obj 136 205 outlet;
#X connect 0 0 2 0;
#X connect 1 0 4 0;
#X connect 2 0 1 0;
#X connect 2 1 4 0;
#X connect 3 0 0 0;
#X restore 132 138 pd hrtf_convert;
#X obj 40 112 inlet~;
#X obj 88 250 outlet~;
#X obj 146 247 outlet~;
#X obj 282 147 switch~;
#X obj 281 122 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X msg 307 105 0;
#X obj 346 73 loadbang;
#X obj 278 70 r HRTF;
#X obj 135 65 inlet;
#X text 103 215 hrtf;
#X connect 0 0 5 0;
#X connect 0 1 2 0;
#X connect 1 0 4 0;
#X connect 2 0 3 0;
#X connect 5 0 1 0;
#X connect 10 0 9 0;
#X connect 11 0 10 0;
#X connect 12 0 11 0;
#X connect 13 0 10 0;
#X connect 14 0 0 0;
#X restore 42 288 pd HRTF;
#X obj 57 162 *~ 0.1;
#X text 100 163 -20 dB;
#X connect 1 0 0 0;
#X connect 1 0 11 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X connect 4 0 27 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 26 1;
#X connect 7 0 16 1;
#X connect 7 1 1 0;
#X connect 7 1 12 0;
#X connect 10 0 9 0;
#X connect 10 1 8 0;
#X connect 11 0 10 0;
#X connect 12 0 14 0;
#X connect 13 0 15 0;
#X connect 14 0 13 0;
#X connect 14 1 16 3;
#X connect 15 0 16 2;
#X connect 17 0 23 0;
#X connect 18 0 21 0;
#X connect 19 0 20 0;
#X connect 20 0 18 0;
#X connect 21 0 16 0;
#X connect 22 0 17 0;
#X connect 22 0 18 0;
#X connect 23 0 26 0;
#X connect 26 0 24 0;
#X connect 26 1 25 0;
#X connect 27 0 21 1;
#X connect 27 0 23 1;
#X restore 178 22 pd testID;
#X text 23 57 represents each ID (sound object);
#X obj 27 22 clone -s 1 64 zirk_id;
#X restore 28 93 pd ids;
#N canvas 424 327 392 116 speakers 0;
#X obj 201 26 catch~ out0;
#X text 14 53 represent speaker. The connection of speaker and hardware
out can be configurable. Thus the numbers above are NOT hardware out
channels.;
#X obj 17 25 clone -s 1 64 zirk_speaker;
#X restore 28 116 pd speakers;
#N canvas 159 321 263 80 outputs 0;
#X text 40 16 hardware out | max 64 channels;
#X obj 43 40 clone -s 1 64 zirk_output;
#X restore 28 139 pd outputs;
#X obj 29 12 r #zirk-in;
#X text 191 73 input & source layer;
#X connect 4 0 0 1;
#X connect 13 0 0 0;
